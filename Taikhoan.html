<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T√†i kho·∫£n c·ªßa t√¥i - VietTechStore</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        body {
            background-color: #f5f5f5;
        }
        
        .account-page {
            display: flex;
            max-width: 1200px;
            margin: 40px auto;
            gap: 20px;
            padding: 20px;
        }
        
        .account-sidebar {
            width: 280px;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            height: fit-content;
        }
        
        .user-profile {
            text-align: center;
            padding-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
            margin-bottom: 20px;
        }
        
        .user-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 32px;
            color: #666;
        }
        
        .user-name {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        
        .user-phone {
            font-size: 14px;
            color: #666;
        }
        
        .sidebar-menu {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .sidebar-menu li {
            margin-bottom: 5px;
        }
        
        .sidebar-menu a {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 15px;
            color: #333;
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.3s;
        }
        
        .sidebar-menu a:hover {
            background-color: #f5f5f5;
        }
        
        .sidebar-menu a.active {
            background-color: #e3f2fd;
            color: #007bff;
        }
        
        .sidebar-menu a.active i {
            color: #007bff;
        }
        
        .sidebar-menu i {
            width: 20px;
            color: #666;
        }
        
        .account-content {
            flex: 1;
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .content-section {
            display: none;
        }
        
        .content-section.active {
            display: block;
        }
        
        .section-title {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin-bottom: 25px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }
        
        .form-group input:disabled {
            background-color: #f5f5f5;
            cursor: not-allowed;
        }
        
        .radio-group {
            display: flex;
            gap: 20px;
        }
        
        .radio-group label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: normal;
            cursor: pointer;
        }
        
        .radio-group input[type="radio"] {
            width: auto;
        }
        
        .btn-save {
            background-color: #007bff;
            color: white;
            padding: 12px 40px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 20px;
        }
        
        .btn-save:hover {
            background-color: #0056b3;
        }
        
        /* Table styles from admin */
        .table-wrap {
            background: white;
            border-radius: 16px;
            border: 1px solid #e2e8f0;
            padding: 10px 12px;
        }
        
        .toolbar {
            margin-bottom: 10px;
        }
        
        .input {
            width: 100%;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
            padding: 7px 9px;
            font-size: 13px;
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }
        
        .table th,
        .table td {
            padding: 8px 10px;
            border-bottom: 1px solid #e2e8f0;
            text-align: left;
        }
        
        .table th {
            font-size: 12px;
            text-transform: uppercase;
            color: #64748b;
            font-weight: 600;
        }
        
        .table tr:last-child td {
            border-bottom: none;
        }
        
        .table tbody tr:hover {
            background-color: #f8f9fa;
        }
        
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
        }
        
        .badge--warn {
            background-color: #fef3c7;
            color: #92400e;
        }
        
        .badge--ok {
            background-color: #dcfce7;
            color: #16a34a;
        }
        
        .badge--info {
            background-color: #dbeafe;
            color: #1e40af;
        }
        
        .badge--info-shipping {
            background-color: #e0e7ff;
            color: #4338ca;
        }
        
        .badge--danger {
            background-color: #fee2e2;
            color: #dc2626;
        }
        
        .section__header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 14px;
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }
        
        .empty-state i {
            font-size: 64px;
            color: #ccc;
            margin-bottom: 20px;
        }
        
        .btn-cancel {
            background-color: #dc3545;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            transition: background-color 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        
        .btn-cancel:hover {
            background-color: #c82333;
        }
        
        .btn-cancel i {
            font-size: 11px;
        }
        
        .table td:last-child {
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- Header t·ª´ index.html -->
    <div class="top-header">
        <div class="container"> 
            <div class="logo">
                <img src="anh/logo.jpg" alt="logo">
                <div class="contact-info">
                    <p><b>VietTechStore</b></p>
                    <p><b>079.949.6002</b></p>
                </div>
                <div class="contact-icons">
                    <a href="tel:0123456789" target="_blank">
                        <img src="anh/contact_icon_1.png" alt="G·ªçi ƒëi·ªán">
                    </a>
                    <a href="https://zalo.me/0123456789" target="_blank">
                        <img src="anh/contact_icon_2.png" alt="Zalo">
                    </a>
                    <a href="https://m.me/yourpageid" target="_blank">
                        <img src="anh/contact_icon_3.png" alt="Messenger">
                    </a>
                </div>
            </div>
            <nav class="menu">
                <a href="index.html">Gi·ªõi thi·ªáu</a>
                <div class="dropdown">
                    <a href="#">Laptop</a>
                    <div class="dropdown-content">
                        <div class="cot">
                            <p>HP</p>
                            <ul>
                                <li><a href="#">HP Probook</a></li>
                                <li><a href="#">HP Folio</a></li>
                                <li><a href="#">HP Elitebook</a></li>
                                <li><a href="#">HP Spectre</a></li>
                                <li><a href="#">HP Pavilion</a></li>
                                <li><a href="#">HP Envy</a></li>
                            </ul>
                        </div>
                        <div class="cot">
                            <p>ASUS</p>
                            <ul>
                                <li><a href="#">Asus S Series</a></li>
                                <li><a href="#">Asus Vivobook Series</a></li>
                                <li><a href="#">Asus Zenbook Series</a></li>
                                <li><a href="#">Asus TUF</a></li>
                            </ul>
                        </div>
                        <div class="cot">
                            <p>DELL</p>
                            <ul>
                                <li><a href="#">Dell XPS</a></li>
                                <li><a href="#">Dell Precision</a></li>
                                <li><a href="#">Dell Latitude</a></li>
                                <li><a href="#">Dell Inspiron</a></li>
                                <li><a href="#">Dell Alienware</a></li>
                            </ul>
                        </div>
                        <div class="cot">
                            <p>LENOVO</p>
                            <ul>
                                <li><a href="#">Lenovo Yoga Series</a></li>
                                <li><a href="muclenovo.html">Lenovo Gaming</a></li>
                                <li><a href="#">Lenovo Legion</a></li>
                                <li><a href="#">IdeaPad</a></li>
                                <li><a href="#">IdeaPad Gaming</a></li>
                                <li><a href="#">Thinkbook</a></li>
                            </ul>
                        </div>
                        <div class="cot">
                            <p>THINKPAD</p>
                            <ul>
                                <li><a href="#">ThinkPad X1 Carbon</a></li>
                                <li><a href="#">ThinkPad X Series</a></li>
                                <li><a href="#">ThinkPad E Series</a></li>
                                <li><a href="#">ThinkPad T Series</a></li>
                                <li><a href="#">ThinkPad Workstations</a></li>
                            </ul>
                        </div>
                        <div class="cot">
                            <p>Theo nhu c·∫ßu</p>
                            <ul>
                                <li><a href="#">M·ªèng Nh·∫π</a></li>
                                <li><a href="#">Workstations</a></li>
                                <li><a href="#">Si√™u ph·∫©m</a></li>
                                <li><a href="#">ƒê·ªì H·ªça, K·ªπ thu·∫≠t</a></li>
                                <li><a href="#">H·ªçc t·∫≠p, VƒÉn ph√≤ng</a></li>
                                <li><a href="#">L·∫≠p tr√¨nh</a></li>
                                <li><a href="#">Game</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="dropdown">
                    <a href="#">Ph·ª• ki·ªán</a>
                    <div class="dropdown-content">
                        <div class="cot">
                            <p>Ph·ª• ki·ªán</p>
                            <ul>
                                <li><a href="#">Tai nghe</a></li>
                                <li><a href="#">Chu·ªôt</a></li>
                                <li><a href="#">B√†n ph√≠m</a></li>
                                <li><a href="#">C√°p s·∫°c</a></li>
                            </ul>
                        </div>
                        <div class="cot">
                            <p>Kh√°c</p>
                            <ul>
                                <li><a href="#">·ªî c·ª©ng</a></li>
                                <li><a href="#">RAM</a></li>
                                <li><a href="#">Pin</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <a href="#">Khuy·∫øn m√£i</a>
            </nav>
            <div class="mobile-menu-toggle" onclick="toggleMobileMenu()">
                <i class="fa fa-bars"></i>
            </div>
            <div class="search-bar">
                <input type="text" placeholder="T√¨m ki·∫øm laptop v√† ph·ª• ki·ªán">
                <button><i class="fa fa-search"></i></button>
            </div>
            <div class="icons">
                <a href="Giohang.html">
                    <i class="fa fa-shopping-cart"></i>
                    <span id="cartCount">0</span>
                </a>
                <div id="userDisplay" class="user-dropdown-container">
                    <a href="Dangnhap.html" id="userLink"><i class="fa fa-user"></i></a>
                    <div id="userDropdown" class="user-dropdown-menu">
                        <a href="Taikhoan.html" class="dropdown-item">
                            <i class="fa fa-user-circle"></i> T√†i kho·∫£n
                        </a>
                        <div class="dropdown-divider"></div>
                        <a href="#" id="logoutLink" class="dropdown-item logout-item">
                            <i class="fa fa-sign-out-alt"></i> ƒêƒÉng xu·∫•t
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <nav class="mobile-menu" id="mobileMenu">
            <a href="index.html">Gi·ªõi thi·ªáu</a>
            <a href="#">Laptop</a>
            <a href="#">Ph·ª• ki·ªán</a>
            <a href="#">Khuy·∫øn m√£i</a>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="account-page">
        <!-- Sidebar -->
        <div class="account-sidebar">
            <div class="user-profile">
                <div class="user-avatar">
                    <i class="fa fa-user"></i>
                </div>
                <div class="user-name" id="sidebarUserName">Nguy·ªÖn Qu·ªëc Vi·ªát</div>
                <div class="user-phone" id="sidebarUserPhone">0799496002</div>
            </div>
            <ul class="sidebar-menu">
                <li><a href="#" class="menu-item active" data-section="info">
                    <i class="fa fa-user"></i> Th√¥ng tin t√†i kho·∫£n
                </a></li>
                <li><a href="#" class="menu-item" data-section="orders">
                    <i class="fa fa-shopping-bag"></i> ƒê∆°n h√†ng c·ªßa b·∫°n
                </a></li>
            </ul>
        </div>

        <!-- Content Area -->
        <div class="account-content">
            <!-- Th√¥ng tin t√†i kho·∫£n -->
            <div class="content-section active" id="infoSection">
                <h2 class="section-title">Th√¥ng tin t√†i kho·∫£n</h2>
                <form id="accountForm">
                    <div class="form-group">
                        <label>H·ªç T√™n</label>
                        <input type="text" id="fullName" required>
                    </div>
                    <div class="form-group">
                        <label>Gi·ªõi t√≠nh</label>
                        <div class="radio-group">
                            <label>
                                <input type="radio" name="gender" value="male" checked> Nam
                            </label>
                            <label>
                                <input type="radio" name="gender" value="female"> N·ªØ
                            </label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>S·ªë ƒëi·ªán tho·∫°i</label>
                        <input type="tel" id="phone">
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="email" disabled>
                    </div>
                    <div class="form-group">
                        <label>T√†i kho·∫£n</label>
                        <input type="text" id="username" disabled>
                    </div>
                    <button type="submit" class="btn-save">L∆ØU THAY ƒê·ªîI</button>
                </form>
                
                <!-- Form ƒë·ªïi m·∫≠t kh·∫©u -->
                <div style="margin-top: 40px; padding-top: 30px; border-top: 1px solid #e0e0e0;">
                    <h3 class="section-title" style="font-size: 20px; margin-bottom: 20px;">ƒê·ªïi m·∫≠t kh·∫©u</h3>
                    <form id="changePasswordForm">
                        <div class="form-group">
                            <label>M·∫≠t kh·∫©u hi·ªán t·∫°i</label>
                            <input type="password" id="currentPassword" required>
                        </div>
                        <div class="form-group">
                            <label>M·∫≠t kh·∫©u m·ªõi</label>
                            <input type="password" id="newPassword" required minlength="6">
                        </div>
                        <div class="form-group">
                            <label>X√°c nh·∫≠n m·∫≠t kh·∫©u m·ªõi</label>
                            <input type="password" id="confirmPassword" required minlength="6">
                        </div>
                        <button type="submit" class="btn-save">ƒê·ªîI M·∫¨T KH·∫®U</button>
                    </form>
                </div>
            </div>

            <!-- ƒê∆°n h√†ng c·ªßa b·∫°n -->
            <div class="content-section" id="ordersSection">
                <div class="section__header">
                    <h2 class="section-title">ƒê∆°n h√†ng c·ªßa b·∫°n</h2>
                </div>
                <div class="table-wrap">
                    <div class="toolbar">
                        <input
                            id="orderSearch"
                            class="input"
                            placeholder="üîç T√¨m ki·∫øm ƒë∆°n h√†ng..."
                        />
                    </div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>M√£ ƒë∆°n</th>
                                <th>S·∫£n ph·∫©m</th>
                                <th>T·ªïng ti·ªÅn</th>
                                <th>Tr·∫°ng th√°i</th>
                                <th>Ng√†y ƒë·∫∑t</th>
                                <th>Thao t√°c</th>
                            </tr>
                        </thead>
                        <tbody id="ordersTableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer t·ª´ index.html -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-column">
                <h4>V·ªÄ VIETTECH</h4>
                <ul>
                    <li><a href="#">Gi·ªõi thi·ªáu</a></li>
                    <li><a href="#">Tuy·ªÉn d·ª•ng</a></li>
                    <li><a href="#">Li√™n h·ªá</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h4>CH√çNH S√ÅCH</h4>
                <ul>
                    <li><a href="#">Ch√≠nh s√°ch b·∫£o h√†nh</a></li>
                    <li><a href="#">Ch√≠nh s√°ch giao h√†ng</a></li>
                    <li><a href="#">Ch√≠nh s√°ch b·∫£o m·∫≠t</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h4>TH√îNG TIN</h4>
                <ul>
                    <li><a href="#">H·ªá th·ªëng c·ª≠a h√†ng</a></li>
                    <li><a href="#">H∆∞·ªõng d·∫´n mua h√†ng</a></li>
                    <li><a href="#">H∆∞·ªõng d·∫´n thanh to√°n</a></li>
                    <li><a href="#">H∆∞·ªõng d·∫´n tr·∫£ g√≥p</a></li>
                    <li><a href="#">Tra c·ª©u ƒë·ªãa ch·ªâ b·∫£o h√†nh</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h4>T·ªîNG ƒê√ÄI H·ªñ TR·ª¢ (8:00 - 21:00)</h4>
                <ul>
                    <li>Mua h√†ng: <a href="tel:19005301">1900.5301</a></li>
                    <li>B·∫£o h√†nh: <a href="tel:19005325">1900.5325</a></li>
                    <li>Ki·∫øu n·∫°i: <a href="tel:18006173">1800.6173</a></li>
                    <li>Email: <a href="mailto:cskh@viettech.com">cskh@VietTechStore .com</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h4>B·∫¢N ƒê·ªí</h4>
                <div class="map-container">
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d14931.339738709165!2d106.05463020248972!3d20.676293444177908!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3135c0cd38f568f3%3A0x50681a4fcf414c4b!2zQW4gVOG6o28sIFRwLiBIxrBuZyBZw6puLCBIxrBuZyBZw6puLCBWaeG7h3QgTmFt!5e0!3m2!1svi!2s!4v1743648692178!5m2!1svi!2s" width="400" height="300" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                </div>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
    <script src="Dongbogiohang.js"></script>
    <script src="product-reload.js"></script>
    <script>
        // Load user info
        function loadUserInfo() {
            try {
                const currentUserStr = localStorage.getItem('currentUser');
                if (currentUserStr) {
                    const currentUser = JSON.parse(currentUserStr);
                    
                    // Update sidebar
                    document.getElementById('sidebarUserName').textContent = currentUser.name || 'Ng∆∞·ªùi d√πng';
                    document.getElementById('sidebarUserPhone').textContent = currentUser.phone || '';
                    
                    // Update form
                    document.getElementById('fullName').value = currentUser.name || '';
                    document.getElementById('phone').value = currentUser.phone || '';
                    document.getElementById('email').value = currentUser.email || '';
                    
                    // Load username from customers data
                    const LS_KEY = "laptop_admin_data_v1";
                    const adminData = JSON.parse(localStorage.getItem(LS_KEY) || '{}');
                    if (adminData.customers) {
                        const customer = adminData.customers.find(c => c.email === currentUser.email);
                        if (customer && customer.username) {
                            document.getElementById('username').value = customer.username;
                        }
                    }
                    
                    // Update header user display
                    const userLink = document.getElementById('userLink');
                    if (userLink && currentUser.name && currentUser.role === 'user') {
                        userLink.innerHTML = `
                            <i class="fa fa-user"></i>
                            <div class="user-greeting">
                                <div class="greeting-text">Xin ch√†o</div>
                                <div class="user-name">${currentUser.name}</div>
                            </div>
                        `;
                        userLink.classList.add('user-logged-in');
                        userLink.style.textDecoration = 'none';
                    }
                } else {
                    window.location.href = 'Dangnhap.html';
                }
            } catch (e) {
                console.error("L·ªói:", e);
            }
        }
        
        // Menu navigation
        document.querySelectorAll('.menu-item').forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
                const section = this.dataset.section;
                
                // Update active menu
                document.querySelectorAll('.menu-item').forEach(m => m.classList.remove('active'));
                this.classList.add('active');
                
                // Show corresponding section
                document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
                document.getElementById(section + 'Section').classList.add('active');
                
                if (section === 'orders') {
                    loadOrders();
                }
            });
        });
        
        // Load orders in table format
        function loadOrders() {
            const ordersTableBody = document.getElementById('ordersTableBody');
            if (!ordersTableBody) return;
            
            try {
                const currentUserStr = localStorage.getItem('currentUser');
                if (!currentUserStr) {
                    ordersTableBody.innerHTML = '<tr><td colspan="5" style="text-align:center;color:#64748b;padding:28px">Vui l√≤ng ƒëƒÉng nh·∫≠p</td></tr>';
                    return;
                }
                
                const currentUser = JSON.parse(currentUserStr);
                const LS_KEY = "laptop_admin_data_v1";
                const adminData = JSON.parse(localStorage.getItem(LS_KEY) || '{}');
                const orders = adminData.orders || [];
                
                // Filter by user
                let userOrders = orders.filter(order => 
                    order.customerEmail === currentUser.email || 
                    order.customerName === currentUser.name
                );
                
                // Sort by date
                userOrders.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
                
                // Search filter
                const searchTerm = (document.getElementById('orderSearch')?.value || '').toLowerCase();
                if (searchTerm) {
                    userOrders = userOrders.filter(order => 
                        order.id.toLowerCase().includes(searchTerm) ||
                        (order.productName || '').toLowerCase().includes(searchTerm)
                    );
                }
                
                if (userOrders.length === 0) {
                    ordersTableBody.innerHTML = '<tr><td colspan="6" style="text-align:center;color:#64748b;padding:28px">Ch∆∞a c√≥ ƒë∆°n h√†ng</td></tr>';
                    return;
                }
                
                const statusMap = {
                    'pending': { text: 'Ch·ªù x√°c nh·∫≠n', class: 'badge--warn' },
                    'processing': { text: 'ƒêang x·ª≠ l√Ω', class: 'badge--info' },
                    'shipping': { text: 'ƒêang giao', class: 'badge--info-shipping' },
                    'completed': { text: 'Ho√†n th√†nh', class: 'badge--ok' },
                    'cancelled': { text: 'ƒê√£ h·ªßy', class: 'badge--danger' }
                };
                
                const money = (n) => new Intl.NumberFormat('vi-VN', {
                    style: 'currency',
                    currency: 'VND'
                }).format(n || 0);
                
                ordersTableBody.innerHTML = userOrders.map(order => {
                    const date = new Date(order.createdAt);
                    const dateStr = date.toLocaleDateString('vi-VN', {
                        day: '2-digit',
                        month: '2-digit',
                        year: 'numeric'
                    });
                    
                    const status = statusMap[order.status] || statusMap['pending'];
                    
                    // Ch·ªâ cho ph√©p h·ªßy ƒë∆°n n·∫øu tr·∫°ng th√°i l√† pending, processing ho·∫∑c shipping (gi·ªëng admin)
                    const canCancel = order.status === 'pending' || order.status === 'processing' || order.status === 'shipping';
                    const cancelButton = canCancel 
                        ? `<button class="btn-cancel" onclick="cancelOrder('${order.id}')" title="H·ªßy ƒë∆°n h√†ng">
                            <i class="fa fa-times"></i> H·ªßy ƒë∆°n
                           </button>`
                        : '<span style="color: #999; font-size: 12px;">-</span>';
                    
                    return `
                        <tr>
                            <td><strong>${order.id}</strong></td>
                            <td>${order.productName || 'N/A'}</td>
                            <td><strong>${money(order.totalAmount)}</strong></td>
                            <td><span class="badge ${status.class}">${status.text}</span></td>
                            <td>${dateStr}</td>
                            <td>${cancelButton}</td>
                        </tr>
                    `;
                }).join('');
            } catch (e) {
                console.error("L·ªói:", e);
                ordersTableBody.innerHTML = '<tr><td colspan="6" style="text-align:center;color:#64748b;padding:28px">C√≥ l·ªói x·∫£y ra</td></tr>';
            }
        }
        
        // H·ªßy ƒë∆°n h√†ng
        function cancelOrder(orderId) {
            if (!confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën h·ªßy ƒë∆°n h√†ng n√†y?')) {
                return;
            }
            
            try {
                const LS_KEY = "laptop_admin_data_v1";
                const adminData = JSON.parse(localStorage.getItem(LS_KEY) || '{}');
                const orders = adminData.orders || [];
                
                // T√¨m v√† c·∫≠p nh·∫≠t tr·∫°ng th√°i ƒë∆°n h√†ng
                const orderIndex = orders.findIndex(order => order.id === orderId);
                if (orderIndex !== -1) {
                    const order = orders[orderIndex];
                    
                    // Ki·ªÉm tra xem ƒë∆°n h√†ng c√≥ th·ªÉ h·ªßy kh√¥ng
                    if (order.status === 'completed') {
                        alert('Kh√¥ng th·ªÉ h·ªßy ƒë∆°n h√†ng ƒë√£ ho√†n th√†nh!');
                        return;
                    }
                    
                    if (order.status === 'cancelled') {
                        alert('ƒê∆°n h√†ng n√†y ƒë√£ ƒë∆∞·ª£c h·ªßy tr∆∞·ªõc ƒë√≥!');
                        return;
                    }
                    
                    // C·∫≠p nh·∫≠t tr·∫°ng th√°i th√†nh 'cancelled'
                    orders[orderIndex].status = 'cancelled';
                    adminData.orders = orders;
                    localStorage.setItem(LS_KEY, JSON.stringify(adminData));
                    
                    alert('ƒê√£ h·ªßy ƒë∆°n h√†ng th√†nh c√¥ng!');
                    
                    // Reload danh s√°ch ƒë∆°n h√†ng
                    loadOrders();
                } else {
                    alert('Kh√¥ng t√¨m th·∫•y ƒë∆°n h√†ng!');
                }
            } catch (e) {
                console.error("L·ªói:", e);
                alert('C√≥ l·ªói x·∫£y ra khi h·ªßy ƒë∆°n h√†ng!');
            }
        }
        
        // Search orders
        const orderSearch = document.getElementById('orderSearch');
        if (orderSearch) {
            orderSearch.addEventListener('input', loadOrders);
        }
        
        // Save account info
        document.getElementById('accountForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const fullName = document.getElementById('fullName').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const gender = document.querySelector('input[name="gender"]:checked').value;
            
            if (!fullName) {
                alert('Vui l√≤ng nh·∫≠p h·ªç v√† t√™n');
                return;
            }
            
            try {
                const currentUserStr = localStorage.getItem('currentUser');
                if (currentUserStr) {
                    const currentUser = JSON.parse(currentUserStr);
                    currentUser.name = fullName;
                    currentUser.phone = phone;
                    currentUser.gender = gender;
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    
                    // Update in admin data
                    const LS_KEY = "laptop_admin_data_v1";
                    const adminData = JSON.parse(localStorage.getItem(LS_KEY) || '{}');
                    if (adminData.customers) {
                        const customer = adminData.customers.find(c => c.email === currentUser.email);
                        if (customer) {
                            customer.name = fullName;
                            customer.phone = phone;
                            localStorage.setItem(LS_KEY, JSON.stringify(adminData));
                        }
                    }
                    
                    // Update sidebar
                    document.getElementById('sidebarUserName').textContent = fullName;
                    document.getElementById('sidebarUserPhone').textContent = phone;
                    
                    alert('ƒê√£ l∆∞u th√¥ng tin th√†nh c√¥ng!');
                }
            } catch (e) {
                console.error("L·ªói:", e);
                alert('C√≥ l·ªói x·∫£y ra khi l∆∞u th√¥ng tin');
            }
        });
        
        // Change password
        document.getElementById('changePasswordForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            // Validation
            if (!currentPassword || !newPassword || !confirmPassword) {
                alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin!');
                return;
            }
            
            if (newPassword.length < 6) {
                alert('M·∫≠t kh·∫©u m·ªõi ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª±!');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                alert('M·∫≠t kh·∫©u x√°c nh·∫≠n kh√¥ng kh·ªõp!');
                return;
            }
            
            if (currentPassword === newPassword) {
                alert('M·∫≠t kh·∫©u m·ªõi ph·∫£i kh√°c m·∫≠t kh·∫©u hi·ªán t·∫°i!');
                return;
            }
            
            try {
                const currentUserStr = localStorage.getItem('currentUser');
                if (!currentUserStr) {
                    alert('Vui l√≤ng ƒëƒÉng nh·∫≠p l·∫°i!');
                    window.location.href = 'Dangnhap.html';
                    return;
                }
                
                const currentUser = JSON.parse(currentUserStr);
                const LS_KEY = "laptop_admin_data_v1";
                const adminData = JSON.parse(localStorage.getItem(LS_KEY) || '{}');
                
                if (!adminData.customers) {
                    alert('Kh√¥ng t√¨m th·∫•y th√¥ng tin t√†i kho·∫£n!');
                    return;
                }
                
                // T√¨m customer theo email
                const customer = adminData.customers.find(c => c.email === currentUser.email);
                if (!customer) {
                    alert('Kh√¥ng t√¨m th·∫•y th√¥ng tin t√†i kho·∫£n!');
                    return;
                }
                
                // Ki·ªÉm tra m·∫≠t kh·∫©u hi·ªán t·∫°i
                if (customer.password !== currentPassword) {
                    alert('M·∫≠t kh·∫©u hi·ªán t·∫°i kh√¥ng ƒë√∫ng!');
                    return;
                }
                
                // C·∫≠p nh·∫≠t m·∫≠t kh·∫©u m·ªõi
                customer.password = newPassword;
                adminData.customers = adminData.customers.map(c => 
                    c.email === currentUser.email ? customer : c
                );
                
                localStorage.setItem(LS_KEY, JSON.stringify(adminData));
                
                // X√≥a c√°c tr∆∞·ªùng m·∫≠t kh·∫©u
                document.getElementById('currentPassword').value = '';
                document.getElementById('newPassword').value = '';
                document.getElementById('confirmPassword').value = '';
                
                alert('ƒê·ªïi m·∫≠t kh·∫©u th√†nh c√¥ng!');
            } catch (e) {
                console.error("L·ªói:", e);
                alert('C√≥ l·ªói x·∫£y ra khi ƒë·ªïi m·∫≠t kh·∫©u!');
            }
        });
        
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadUserInfo();
        });
    </script>
    <style>
        .icons {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .user-dropdown-container {
            position: relative;
        }
        
        .icons a.user-logged-in {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            background-color: #007bff;
            color: white;
            border-radius: 6px;
            transition: background-color 0.3s;
            text-decoration: none;
            height: fit-content;
            cursor: pointer;
            pointer-events: auto;
        }
        
        .icons a.user-logged-in:hover {
            background-color: #0056b3;
        }
        
        .icons a.user-logged-in i {
            font-size: 16px;
            color: white;
        }
        
        .icons a.user-logged-in .user-greeting {
            display: flex;
            flex-direction: column;
            line-height: 1.2;
        }
        
        .icons a.user-logged-in .greeting-text {
            font-size: 10px;
            opacity: 0.9;
        }
        
        .icons a.user-logged-in .user-name {
            font-size: 12px;
            font-weight: 600;
            white-space: nowrap;
        }
        
        .user-dropdown-menu {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 5px;
            background-color: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            min-width: 200px;
            z-index: 1000;
            overflow: hidden;
        }
        
        .user-dropdown-container:hover .user-dropdown-menu,
        .user-dropdown-menu:hover {
            display: block;
        }
        
        /* T·∫°o v√πng v√¥ h√¨nh ƒë·ªÉ k·∫øt n·ªëi banner v√† dropdown - gi√∫p di chu·ªôt kh√¥ng b·ªã m·∫•t */
        .user-dropdown-container::after {
            content: '';
            position: absolute;
            top: 100%;
            right: 0;
            width: 100%;
            height: 5px;
            background: transparent;
            pointer-events: none;
        }
        
        .user-dropdown-menu .dropdown-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 16px;
            color: #333;
            text-decoration: none;
            transition: background-color 0.2s;
            font-size: 14px;
        }
        
        .user-dropdown-menu .dropdown-item:hover {
            background-color: #f5f5f5;
        }
        
        .user-dropdown-menu .dropdown-item i {
            width: 18px;
            color: #666;
        }
        
        .user-dropdown-menu .dropdown-divider {
            height: 1px;
            background-color: #e0e0e0;
            margin: 4px 0;
        }
        
        .user-dropdown-menu .logout-item {
            color: #dc3545;
        }
        
        .user-dropdown-menu .logout-item:hover {
            background-color: #fee;
        }
        
        .user-dropdown-menu .logout-item i {
            color: #dc3545;
        }
    </style>
</body>
</html>

